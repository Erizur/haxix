// Generated by HLC 5.0.0 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <hxd/impl/Allocator.h>
#include <hxd/BufferFormat.h>
#include <hl/types/ArrayObj.h>
#include <h3d/BufferFlag.h>
#include <h3d/Buffer.h>
extern hl_type t$h3d_BufferFlag;
#include <hl/natives.h>
extern venum* g$h3d_BufferFlag_Dynamic;
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
extern venum* g$h3d_BufferFlag_UniformBuffer;
extern hl_type t$h3d_Buffer;
void h3d_Buffer_new(h3d__Buffer,int,hxd__BufferFormat,hl__types__ArrayObj);
#include <hl/types/ArrayBytes_hl_F32.h>
h3d__Buffer hxd_impl_Allocator_ofSubFloats(hxd__impl__Allocator,hl__types__ArrayBytes_hl_F32,int,hxd__BufferFormat,int*);
void h3d_Buffer_uploadFloats(h3d__Buffer,hl__types__ArrayBytes_hl_F32,int,int,int*);
void h3d_Buffer_dispose(h3d__Buffer);
#include <h3d/Indexes.h>
extern hl_type t$h3d_Indexes;
void h3d_Indexes_new(h3d__Indexes,int,bool*);
#include <hl/types/ArrayBytes_hl_UI16.h>
void h3d_Indexes_upload(h3d__Indexes,hl__types__ArrayBytes_hl_UI16,int,int,int*);
void h3d_Indexes_dispose(h3d__Indexes);
extern hxd__impl__$Allocator g$_hxd_impl_Allocator;
extern hl_type t$hxd_impl_Allocator;

void hxd_impl_Allocator_new(hxd__impl__Allocator r0) {
	return;
}

h3d__Buffer hxd_impl_Allocator_allocBuffer(hxd__impl__Allocator r0,int r1,hxd__BufferFormat r2,int* r3) {
	hl__types__ArrayObj r7, r8;
	venum *r11;
	hl_type *r10;
	h3d__Buffer r12;
	varray *r9;
	int r4, r6;
	if( r3 ) goto label$a63d0b3_2_3;
	r4 = 0;
	goto label$a63d0b3_2_4;
	label$a63d0b3_2_3:
	r4 = *r3;
	label$a63d0b3_2_4:
	switch(r4) {
		default:
			goto label$a63d0b3_2_29;
		case 0:
			r10 = &t$h3d_BufferFlag;
			r6 = 1;
			r9 = hl_alloc_array(r10,r6);
			r11 = (venum*)g$h3d_BufferFlag_Dynamic;
			r6 = 0;
			((venum**)(r9 + 1))[r6] = r11;
			r8 = hl_types_ArrayObj_alloc(r9);
			r7 = r8;
			goto label$a63d0b3_2_29;
		case 1:
			r8 = NULL;
			r7 = r8;
			goto label$a63d0b3_2_29;
		case 2:
			r10 = &t$h3d_BufferFlag;
			r6 = 2;
			r9 = hl_alloc_array(r10,r6);
			r11 = (venum*)g$h3d_BufferFlag_UniformBuffer;
			r6 = 0;
			((venum**)(r9 + 1))[r6] = r11;
			r11 = (venum*)g$h3d_BufferFlag_Dynamic;
			r6 = 1;
			((venum**)(r9 + 1))[r6] = r11;
			r8 = hl_types_ArrayObj_alloc(r9);
			r7 = r8;
	}
	label$a63d0b3_2_29:
	r12 = (h3d__Buffer)hl_alloc_obj(&t$h3d_Buffer);
	h3d_Buffer_new(r12,r1,r2,r7);
	return r12;
}

h3d__Buffer hxd_impl_Allocator_ofFloats(hxd__impl__Allocator r0,hl__types__ArrayBytes_hl_F32 r1,hxd__BufferFormat r2,int* r3) {
	h3d__Buffer r8;
	double r5, r7;
	int r4, r6, r9;
	if( r3 ) goto label$a63d0b3_3_3;
	r4 = 0;
	goto label$a63d0b3_3_4;
	label$a63d0b3_3_3:
	r4 = *r3;
	label$a63d0b3_3_4:
	if( r1 == NULL ) hl_null_access();
	r6 = r1->length;
	r5 = (double)r6;
	if( r2 == NULL ) hl_null_access();
	r6 = r2->stride;
	r7 = (double)r6;
	r5 = r5 / r7;
	r6 = (int)r5;
	r9 = r4;
	r3 = &r9;
	r8 = hxd_impl_Allocator_ofSubFloats(r0,r1,r6,r2,r3);
	return r8;
}

h3d__Buffer hxd_impl_Allocator_ofSubFloats(hxd__impl__Allocator r0,hl__types__ArrayBytes_hl_F32 r1,int r2,hxd__BufferFormat r3,int* r4) {
	h3d__Buffer r6;
	int r5, r7, r8;
	if( r4 ) goto label$a63d0b3_4_3;
	r5 = 0;
	goto label$a63d0b3_4_4;
	label$a63d0b3_4_3:
	r5 = *r4;
	label$a63d0b3_4_4:
	r8 = r5;
	r4 = &r8;
	r6 = hxd_impl_Allocator_allocBuffer(r0,r2,r3,r4);
	if( r6 == NULL ) hl_null_access();
	r7 = 0;
	r4 = NULL;
	h3d_Buffer_uploadFloats(r6,r1,r7,r2,r4);
	return r6;
}

void hxd_impl_Allocator_disposeBuffer(hxd__impl__Allocator r0,h3d__Buffer r1) {
	if( r1 == NULL ) hl_null_access();
	h3d_Buffer_dispose(r1);
	return;
}

h3d__Indexes hxd_impl_Allocator_allocIndexBuffer(hxd__impl__Allocator r0,int r1) {
	bool *r3;
	h3d__Indexes r2;
	r2 = (h3d__Indexes)hl_alloc_obj(&t$h3d_Indexes);
	r3 = NULL;
	h3d_Indexes_new(r2,r1,r3);
	return r2;
}

h3d__Indexes hxd_impl_Allocator_ofIndexes(hxd__impl__Allocator r0,hl__types__ArrayBytes_hl_UI16 r1,int* r2) {
	h3d__Indexes r7;
	int r3, r5, r6;
	if( r2 ) goto label$a63d0b3_7_3;
	r3 = -1;
	goto label$a63d0b3_7_4;
	label$a63d0b3_7_3:
	r3 = *r2;
	label$a63d0b3_7_4:
	r6 = 0;
	if( r3 >= r6 ) goto label$a63d0b3_7_10;
	if( !r1 ) goto label$a63d0b3_7_10;
	if( r1 == NULL ) hl_null_access();
	r5 = r1->length;
	r3 = r5;
	label$a63d0b3_7_10:
	r7 = hxd_impl_Allocator_allocIndexBuffer(r0,r3);
	if( r7 == NULL ) hl_null_access();
	r5 = 0;
	r2 = NULL;
	h3d_Indexes_upload(r7,r1,r5,r3,r2);
	return r7;
}

void hxd_impl_Allocator_disposeIndexBuffer(hxd__impl__Allocator r0,h3d__Indexes r1) {
	if( r1 == NULL ) hl_null_access();
	h3d_Indexes_dispose(r1);
	return;
}

void hxd_impl_Allocator_onContextLost(hxd__impl__Allocator r0) {
	return;
}

hxd__impl__Allocator hxd_impl_Allocator_get() {
	hxd__impl__Allocator r1;
	hxd__impl__$Allocator r2;
	r2 = (hxd__impl__$Allocator)g$_hxd_impl_Allocator;
	r1 = r2->inst;
	if( r1 ) goto label$a63d0b3_10_7;
	r1 = (hxd__impl__Allocator)hl_alloc_obj(&t$hxd_impl_Allocator);
	hxd_impl_Allocator_new(r1);
	r2 = (hxd__impl__$Allocator)g$_hxd_impl_Allocator;
	r2->inst = r1;
	label$a63d0b3_10_7:
	r2 = (hxd__impl__$Allocator)g$_hxd_impl_Allocator;
	r1 = r2->inst;
	return r1;
}

