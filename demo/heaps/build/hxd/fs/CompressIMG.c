// Generated by HLC 5.0.0 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <hxd/fs/CompressIMG.h>
#include <hxd/res/Image.h>
#include <hxd/fs/BytesFileEntry.h>
extern hl_type t$hxd_res_Image;
extern hl_type t$hxd_fs_BytesFileEntry;
haxe__io__Bytes sys_io_File_getBytes(String);
void hxd_fs_BytesFileEntry_new(hxd__fs__BytesFileEntry,String,haxe__io__Bytes);
#include <hxd/fs/FileEntry.h>
void hxd_res_Image_new(hxd__res__Image,hxd__fs__FileEntry);
#include <hxd/Pixels.h>
#include <hxd/PixelFormat.h>
#include <haxe/io/Path.h>
#include <hl/types/ArrayDyn.h>
#include <haxe/Log.h>
#include <hxd/res/ImageInfo.h>
extern String s$mips;
bool hxd_fs_Convert_hasParam(hxd__fs__Convert,String);
vdynamic* hxd_fs_Convert_getParam(hxd__fs__Convert,String);
extern String s$size;
extern hl_type t$_i32;
extern hl_type t$_dyn;
hxd__Pixels hxd_res_Image_getPixels(hxd__res__Image,venum*,vdynamic*);
void hxd_Pixels_dispose(hxd__Pixels);
void Reflect_setField(vdynamic*,String,vdynamic*);
bool Reflect_deleteField(vdynamic*,String);
extern hl_type t$haxe_io_Path;
void haxe_io_Path_new(haxe__io__Path,String);
extern String s$forced_mips_;
String String___add__(String,String);
String haxe_io_Path_toString(haxe__io__Path);
extern hxd__res__$Image g$_hxd_res_Image;
extern String s$TEMP;
String Sys_getEnv(String);
extern String s$_output_resized_;
extern String s$6666cd7;
hl__types__ArrayObj String_split(String,String);
vdynamic* hl_types_ArrayObj_pop(hl__types__ArrayObj);
haxe__io__Bytes hxd_Pixels_toPNG(hxd__Pixels,vdynamic*);
void sys_io_File_saveBytes(String,haxe__io__Bytes);
void sys_FileSystem_deleteFile(String);
extern haxe__$Log g$_haxe_Log;
extern String s$Faile_to_resize;
extern hl_type t$vrt_eaa6a3b;
extern String s$hxd_fs_Convert_hx;
extern hl_type t$String;
extern String s$hxd_fs_CompressIMG;
extern String s$convert;
#include <hl/natives.h>
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
#include <hl/types/ArrayBase.h>
hl__types__ArrayDyn hl_types_ArrayDyn_alloc(hl__types__ArrayBase,bool*);
extern hl_type t$hl_types_ArrayDyn;
extern String s$format;
extern hxd__fs__$CompressIMG g$_hxd_fs_CompressIMG;
vdynamic* haxe_ds_StringMap_get(haxe__ds__StringMap,String);
extern String s$tmp_;
void sys_io_File_copy(String,String);
extern String s$_f;
extern String s$_y;
extern String s$_nologo;
extern String s$_srgb;
extern String s$_m;
extern String s$1;
hl__types__ArrayObj hl_types_ArrayObj_concat(hl__types__ArrayObj,hl__types__ArrayObj);
extern String s$texconv;
void hxd_fs_Convert_command(hxd__fs__Convert,String,hl__types__ArrayObj);
extern String s$tmp_DDS;
void sys_FileSystem_rename(String,String);
extern String s$dds;
int String___compare(String,vdynamic*);
hxd__res__ImageInfo hxd_res_Image_getInfo(hxd__res__Image);
extern hl_type t$hxd_Pixels;
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
haxe__io__Bytes hxd_Pixels_toDDSLayers(hl__types__ArrayObj,bool*);
extern String s$b14a7b8;
String String___alloc__(vbyte*,int);
extern String s$5058f1a;
extern String s$_dds_;
extern String s$653db5a;
extern String s$_miplevels;
extern String s$20;
extern String s$envd;
extern String s$envs;
extern String s$4436f99;
extern String s$_dds;
extern String s$alpha;
extern String s$BC1;
extern String s$_DXT1UseAlpha;
extern String s$_AlphaThreshold;
extern String s$;
String Std_string(vdynamic*);
extern String s$_fd;
extern String s$CompressonatorCLI;
void hxd_fs_Convert_new(hxd__fs__Convert,vvirtual*,String);

hxd__res__Image hxd_fs_CompressIMG_makeImage(hxd__fs__CompressIMG r0,String r1) {
	haxe__io__Bytes r4;
	hxd__fs__BytesFileEntry r3;
	hxd__res__Image r2;
	r2 = (hxd__res__Image)hl_alloc_obj(&t$hxd_res_Image);
	r3 = (hxd__fs__BytesFileEntry)hl_alloc_obj(&t$hxd_fs_BytesFileEntry);
	r4 = sys_io_File_getBytes(r1);
	hxd_fs_BytesFileEntry_new(r3,r1,r4);
	hxd_res_Image_new(r2,((hxd__fs__FileEntry)r3));
	return r2;
}

void hxd_fs_CompressIMG_convert(hxd__fs__CompressIMG r0) {
	bool *r33;
	String r1, r4, r19, r22, r24, r37, r49, r50;
	hxd__Pixels r10, r15;
	haxe__ds__StringMap r34;
	vvirtual *r28;
	hl__types__ArrayObj r23, r38, r39;
	hl_type *r31;
	venum *r12;
	haxe__io__Bytes r25, r46;
	haxe__io__Path r18, r20;
	bool r3, r7, r17;
	haxe__$Log r27;
	hxd__res__ImageInfo r40;
	hxd__fs__$CompressIMG r35;
	hxd__res__$Image r21;
	hl__types__ArrayDyn r29;
	vclosure *r26;
	int *r47;
	hxd__res__Image r9, r11;
	vdynamic *r5, *r6, *r13, *r32, *r36;
	vbyte *r48;
	varray *r30;
	int r8, r14, r16, r41, r42, r43, r44, r45;
	hl_trap_ctx trap$0;
	r1 = NULL;
	r4 = (String)s$mips;
	r3 = hxd_fs_Convert_hasParam(((hxd__fs__Convert)r0),r4);
	if( !r3 ) goto label$02763ed_2_11;
	r4 = (String)s$mips;
	r5 = hxd_fs_Convert_getParam(((hxd__fs__Convert)r0),r4);
	r3 = true;
	r6 = hl_alloc_dynbool(r3);
	{ int i = hl_dyn_compare((vdynamic*)r5,(vdynamic*)r6); if( i != 0 ) goto label$02763ed_2_11; };
	r3 = true;
	goto label$02763ed_2_12;
	label$02763ed_2_11:
	r3 = false;
	label$02763ed_2_12:
	r4 = (String)s$size;
	r7 = hxd_fs_Convert_hasParam(((hxd__fs__Convert)r0),r4);
	if( !r7 ) goto label$02763ed_2_123;
	hl_trap(trap$0,r5,label$02763ed_2_98);
	r4 = (String)s$size;
	r5 = hxd_fs_Convert_getParam(((hxd__fs__Convert)r0),r4);
	r8 = (int)hl_dyn_casti(&r5,&t$_dyn,&t$_i32);
	r4 = r0->srcPath;
	r9 = hxd_fs_CompressIMG_makeImage(r0,r4);
	if( r9 == NULL ) hl_null_access();
	r12 = NULL;
	r13 = NULL;
	r10 = hxd_res_Image_getPixels(r9,r12,r13);
	if( r10 == NULL ) hl_null_access();
	r14 = r10->width;
	r16 = r10->height;
	if( r14 != r16 ) goto label$02763ed_2_96;
	r14 = r10->width;
	if( r8 >= r14 ) goto label$02763ed_2_96;
	hxd_Pixels_dispose(r10);
	if( r3 ) goto label$02763ed_2_38;
	r5 = r0->params;
	r4 = (String)s$mips;
	r17 = true;
	r6 = hl_alloc_dynbool(r17);
	Reflect_setField(r5,r4,r6);
	label$02763ed_2_38:
	r5 = r0->params;
	r4 = (String)s$size;
	r17 = Reflect_deleteField(r5,r4);
	r18 = (haxe__io__Path)hl_alloc_obj(&t$haxe_io_Path);
	r4 = r0->dstPath;
	haxe_io_Path_new(r18,r4);
	r4 = (String)s$forced_mips_;
	r19 = r18->ext;
	r4 = String___add__(r4,r19);
	r18->ext = r4;
	r4 = r0->dstPath;
	r19 = haxe_io_Path_toString(r18);
	r0->dstPath = r19;
	hxd_fs_CompressIMG_convert(r0);
	r0->dstPath = r4;
	r5 = r0->params;
	r19 = (String)s$size;
	r6 = hl_alloc_dynamic(&t$_i32);
	r6->v.i = r8;
	Reflect_setField(r5,r19,r6);
	if( r3 ) goto label$02763ed_2_61;
	r5 = r0->params;
	r19 = (String)s$mips;
	r17 = Reflect_deleteField(r5,r19);
	label$02763ed_2_61:
	r21 = (hxd__res__$Image)g$_hxd_res_Image;
	r14 = r21->MIPMAP_MAX_SIZE;
	r21 = (hxd__res__$Image)g$_hxd_res_Image;
	r21->MIPMAP_MAX_SIZE = r8;
	r19 = haxe_io_Path_toString(r18);
	r11 = hxd_fs_CompressIMG_makeImage(r0,r19);
	if( r11 == NULL ) hl_null_access();
	r12 = NULL;
	r13 = NULL;
	r15 = hxd_res_Image_getPixels(r11,r12,r13);
	r21 = (hxd__res__$Image)g$_hxd_res_Image;
	r21->MIPMAP_MAX_SIZE = r14;
	r19 = (String)s$TEMP;
	r19 = Sys_getEnv(r19);
	r22 = (String)s$_output_resized_;
	r19 = String___add__(r19,r22);
	r22 = r0->srcPath;
	if( r22 == NULL ) hl_null_access();
	r24 = (String)s$6666cd7;
	r23 = String_split(r22,r24);
	if( r23 == NULL ) hl_null_access();
	r5 = hl_types_ArrayObj_pop(r23);
	r22 = (String)r5;
	r19 = String___add__(r19,r22);
	r0->srcPath = r19;
	r19 = r0->srcPath;
	r1 = r19;
	r19 = r0->srcPath;
	if( r15 == NULL ) hl_null_access();
	r13 = NULL;
	r25 = hxd_Pixels_toPNG(r15,r13);
	sys_io_File_saveBytes(r19,r25);
	hxd_Pixels_dispose(r15);
	r19 = haxe_io_Path_toString(r18);
	sys_FileSystem_deleteFile(r19);
	label$02763ed_2_96:
	hl_endtrap(trap$0);
	goto label$02763ed_2_123;
	label$02763ed_2_98:
	r6 = NULL;
	r27 = (haxe__$Log)g$_haxe_Log;
	r26 = r27->trace;
	if( r26 == NULL ) hl_null_access();
	r4 = (String)s$Faile_to_resize;
	r28 = hl_alloc_virtual(&t$vrt_eaa6a3b);
	r19 = (String)s$hxd_fs_Convert_hx;
	if( hl_vfields(r28)[2] ) *(String*)(hl_vfields(r28)[2]) = (String)r19; else hl_dyn_setp(r28->value,37969014/*fileName*/,&t$String,r19);
	r8 = 292;
	if( hl_vfields(r28)[3] ) *(int*)(hl_vfields(r28)[3]) = (int)r8; else hl_dyn_seti(r28->value,371360620/*lineNumber*/,&t$_i32,r8);
	r19 = (String)s$hxd_fs_CompressIMG;
	if( hl_vfields(r28)[0] ) *(String*)(hl_vfields(r28)[0]) = (String)r19; else hl_dyn_setp(r28->value,-63073762/*className*/,&t$String,r19);
	r19 = (String)s$convert;
	if( hl_vfields(r28)[4] ) *(String*)(hl_vfields(r28)[4]) = (String)r19; else hl_dyn_setp(r28->value,302979532/*methodName*/,&t$String,r19);
	r31 = &t$_dyn;
	r8 = 1;
	r30 = hl_alloc_array(r31,r8);
	r8 = 0;
	((vdynamic**)(r30 + 1))[r8] = r5;
	r23 = hl_types_ArrayObj_alloc(r30);
	r7 = true;
	r33 = &r7;
	r29 = hl_types_ArrayDyn_alloc(((hl__types__ArrayBase)r23),r33);
	if( hl_vfields(r28)[1] ) *(hl__types__ArrayDyn*)(hl_vfields(r28)[1]) = (hl__types__ArrayDyn)r29; else hl_dyn_setp(r28->value,-317173289/*customParams*/,&t$hl_types_ArrayDyn,r29);
	r26->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r26->fun)((vdynamic*)r26->value,((vdynamic*)r4),r28) : ((void (*)(vdynamic*,vvirtual*))r26->fun)(((vdynamic*)r4),r28);
	label$02763ed_2_123:
	r4 = (String)s$format;
	r6 = hxd_fs_Convert_getParam(((hxd__fs__Convert)r0),r4);
	r4 = (String)hl_dyn_castp(&r6,&t$_dyn,&t$String);
	r35 = (hxd__fs__$CompressIMG)g$_hxd_fs_CompressIMG;
	r34 = r35->TEXCONV_FMT;
	if( r34 == NULL ) hl_null_access();
	r6 = haxe_ds_StringMap_get(r34,r4);
	r19 = (String)r6;
	if( !r19 ) goto label$02763ed_2_199;
	r18 = (haxe__io__Path)hl_alloc_obj(&t$haxe_io_Path);
	r22 = r0->dstPath;
	haxe_io_Path_new(r18,r22);
	r22 = (String)s$tmp_;
	r20 = (haxe__io__Path)hl_alloc_obj(&t$haxe_io_Path);
	r24 = r0->srcPath;
	haxe_io_Path_new(r20,r24);
	r24 = r20->ext;
	r22 = String___add__(r22,r24);
	r18->ext = r22;
	r22 = haxe_io_Path_toString(r18);
	hl_trap(trap$0,r6,label$02763ed_2_147);
	sys_FileSystem_deleteFile(r22);
	hl_endtrap(trap$0);
	goto label$02763ed_2_148;
	label$02763ed_2_147:
	r32 = NULL;
	label$02763ed_2_148:
	hl_trap(trap$0,r32,label$02763ed_2_153);
	r24 = r0->dstPath;
	sys_FileSystem_deleteFile(r24);
	hl_endtrap(trap$0);
	goto label$02763ed_2_154;
	label$02763ed_2_153:
	r36 = NULL;
	label$02763ed_2_154:
	r24 = r0->srcPath;
	sys_io_File_copy(r24,r22);
	r31 = &t$String;
	r8 = 6;
	r30 = hl_alloc_array(r31,r8);
	r24 = (String)s$_f;
	r8 = 0;
	((String*)(r30 + 1))[r8] = r24;
	r8 = 1;
	((String*)(r30 + 1))[r8] = r19;
	r24 = (String)s$_y;
	r8 = 2;
	((String*)(r30 + 1))[r8] = r24;
	r24 = (String)s$_nologo;
	r8 = 3;
	((String*)(r30 + 1))[r8] = r24;
	r24 = (String)s$_srgb;
	r8 = 4;
	((String*)(r30 + 1))[r8] = r24;
	r8 = 5;
	((String*)(r30 + 1))[r8] = r22;
	r23 = hl_types_ArrayObj_alloc(r30);
	if( r3 ) goto label$02763ed_2_190;
	r31 = &t$String;
	r8 = 2;
	r30 = hl_alloc_array(r31,r8);
	r24 = (String)s$_m;
	r8 = 0;
	((String*)(r30 + 1))[r8] = r24;
	r24 = (String)s$1;
	r8 = 1;
	((String*)(r30 + 1))[r8] = r24;
	r38 = hl_types_ArrayObj_alloc(r30);
	if( r38 == NULL ) hl_null_access();
	r38 = hl_types_ArrayObj_concat(r38,r23);
	r23 = r38;
	label$02763ed_2_190:
	r24 = (String)s$texconv;
	hxd_fs_Convert_command(((hxd__fs__Convert)r0),r24,r23);
	sys_FileSystem_deleteFile(r22);
	r24 = (String)s$tmp_DDS;
	r18->ext = r24;
	r24 = haxe_io_Path_toString(r18);
	r37 = r0->dstPath;
	sys_FileSystem_rename(r24,r37);
	return;
	label$02763ed_2_199:
	r18 = (haxe__io__Path)hl_alloc_obj(&t$haxe_io_Path);
	r22 = r0->srcPath;
	haxe_io_Path_new(r18,r22);
	r22 = r18->ext;
	r24 = (String)s$dds;
	if( r22 != r24 && (!r22 || !r24 || String___compare(r22,(vdynamic*)r24) != 0) ) goto label$02763ed_2_364;
	r22 = r0->srcPath;
	r9 = hxd_fs_CompressIMG_makeImage(r0,r22);
	if( r9 == NULL ) hl_null_access();
	r40 = hxd_res_Image_getInfo(r9);
	if( r40 == NULL ) hl_null_access();
	r8 = r40->layerCount;
	r14 = 1;
	if( r14 >= r8 ) goto label$02763ed_2_364;
	r8 = r40->dataFormat;
	r14 = 4;
	if( r8 != r14 ) goto label$02763ed_2_364;
	r25 = r0->srcBytes;
	r22 = r0->srcPath;
	r8 = 0;
	r14 = r40->layerCount;
	label$02763ed_2_220:
	if( r8 >= r14 ) goto label$02763ed_2_285;
	r16 = r8;
	++r8;
	r31 = &t$hxd_Pixels;
	r41 = 0;
	r30 = hl_alloc_array(r31,r41);
	r23 = hl_types_ArrayObj_alloc(r30);
	r41 = 0;
	if( r40 == NULL ) hl_null_access();
	r42 = r40->mipLevels;
	label$02763ed_2_231:
	if( r41 >= r42 ) goto label$02763ed_2_246;
	r43 = r41;
	++r41;
	if( r9 == NULL ) hl_null_access();
	r12 = NULL;
	if( r40 == NULL ) hl_null_access();
	r45 = r40->mipLevels;
	r44 = r16 * r45;
	r44 = r44 + r43;
	r13 = hl_alloc_dynamic(&t$_i32);
	r13->v.i = r44;
	r10 = hxd_res_Image_getPixels(r9,r12,r13);
	if( r23 == NULL ) hl_null_access();
	r44 = hl_types_ArrayObj_push(r23,((vdynamic*)r10));
	goto label$02763ed_2_231;
	label$02763ed_2_246:
	r33 = NULL;
	r46 = hxd_Pixels_toDDSLayers(r23,r33);
	r41 = 0;
	label$02763ed_2_249:
	if( r23 == NULL ) hl_null_access();
	r43 = r23->length;
	if( r41 >= r43 ) goto label$02763ed_2_264;
	r43 = r23->length;
	if( ((unsigned)r41) < ((unsigned)r43) ) goto label$02763ed_2_257;
	r10 = NULL;
	goto label$02763ed_2_260;
	label$02763ed_2_257:
	r30 = r23->array;
	r6 = ((vdynamic**)(r30 + 1))[r41];
	r10 = (hxd__Pixels)r6;
	label$02763ed_2_260:
	++r41;
	if( r10 == NULL ) hl_null_access();
	hxd_Pixels_dispose(r10);
	goto label$02763ed_2_249;
	label$02763ed_2_264:
	r24 = r0->dstPath;
	if( r18 == NULL ) hl_null_access();
	r37 = r18->file;
	r24 = String___add__(r24,r37);
	r37 = (String)s$b14a7b8;
	r24 = String___add__(r24,r37);
	r41 = r16;
	r47 = &r41;
	r48 = hl_itos(r41,r47);
	r37 = String___alloc__(r48,r41);
	r24 = String___add__(r24,r37);
	r37 = (String)s$5058f1a;
	r24 = String___add__(r24,r37);
	r37 = r18->ext;
	r24 = String___add__(r24,r37);
	sys_io_File_saveBytes(r24,r46);
	r0->srcBytes = r46;
	r0->srcPath = r24;
	hxd_fs_CompressIMG_convert(r0);
	sys_FileSystem_deleteFile(r24);
	goto label$02763ed_2_220;
	label$02763ed_2_285:
	r0->srcBytes = r25;
	r0->srcPath = r22;
	r31 = &t$hxd_Pixels;
	r8 = 0;
	r30 = hl_alloc_array(r31,r8);
	r23 = hl_types_ArrayObj_alloc(r30);
	r8 = 0;
	if( r40 == NULL ) hl_null_access();
	r14 = r40->layerCount;
	label$02763ed_2_294:
	if( r8 >= r14 ) goto label$02763ed_2_333;
	r16 = r8;
	++r8;
	r24 = r0->dstPath;
	if( r18 == NULL ) hl_null_access();
	r37 = r18->file;
	r24 = String___add__(r24,r37);
	r37 = (String)s$b14a7b8;
	r24 = String___add__(r24,r37);
	r41 = r16;
	r47 = &r41;
	r48 = hl_itos(r41,r47);
	r37 = String___alloc__(r48,r41);
	r24 = String___add__(r24,r37);
	r37 = (String)s$_dds_;
	r24 = String___add__(r24,r37);
	r24 = String___add__(r24,r4);
	r37 = (String)s$5058f1a;
	r24 = String___add__(r24,r37);
	r37 = r18->ext;
	r24 = String___add__(r24,r37);
	r11 = hxd_fs_CompressIMG_makeImage(r0,r24);
	r41 = 0;
	if( r40 == NULL ) hl_null_access();
	r42 = r40->mipLevels;
	label$02763ed_2_320:
	if( r41 >= r42 ) goto label$02763ed_2_331;
	r43 = r41;
	++r41;
	if( r11 == NULL ) hl_null_access();
	r12 = NULL;
	r13 = hl_alloc_dynamic(&t$_i32);
	r13->v.i = r43;
	r10 = hxd_res_Image_getPixels(r11,r12,r13);
	if( r23 == NULL ) hl_null_access();
	r44 = hl_types_ArrayObj_push(r23,((vdynamic*)r10));
	goto label$02763ed_2_320;
	label$02763ed_2_331:
	sys_FileSystem_deleteFile(r24);
	goto label$02763ed_2_294;
	label$02763ed_2_333:
	r33 = NULL;
	r46 = hxd_Pixels_toDDSLayers(r23,r33);
	r8 = 0;
	label$02763ed_2_336:
	if( r23 == NULL ) hl_null_access();
	r16 = r23->length;
	if( r8 >= r16 ) goto label$02763ed_2_351;
	r16 = r23->length;
	if( ((unsigned)r8) < ((unsigned)r16) ) goto label$02763ed_2_344;
	r10 = NULL;
	goto label$02763ed_2_347;
	label$02763ed_2_344:
	r30 = r23->array;
	r6 = ((vdynamic**)(r30 + 1))[r8];
	r10 = (hxd__Pixels)r6;
	label$02763ed_2_347:
	++r8;
	if( r10 == NULL ) hl_null_access();
	hxd_Pixels_dispose(r10);
	goto label$02763ed_2_336;
	label$02763ed_2_351:
	r24 = r0->dstPath;
	if( r18 == NULL ) hl_null_access();
	r37 = r18->file;
	r24 = String___add__(r24,r37);
	r37 = (String)s$b14a7b8;
	r24 = String___add__(r24,r37);
	r24 = String___add__(r24,r4);
	r37 = (String)s$5058f1a;
	r24 = String___add__(r24,r37);
	r37 = r18->ext;
	r24 = String___add__(r24,r37);
	sys_io_File_saveBytes(r24,r46);
	return;
	label$02763ed_2_364:
	r31 = &t$String;
	r8 = 1;
	r30 = hl_alloc_array(r31,r8);
	r22 = (String)s$653db5a;
	r8 = 0;
	((String*)(r30 + 1))[r8] = r22;
	r23 = hl_types_ArrayObj_alloc(r30);
	if( !r3 ) goto label$02763ed_2_377;
	if( r23 == NULL ) hl_null_access();
	r22 = (String)s$_miplevels;
	r8 = hl_types_ArrayObj_push(r23,((vdynamic*)r22));
	r22 = (String)s$20;
	r8 = hl_types_ArrayObj_push(r23,((vdynamic*)r22));
	label$02763ed_2_377:
	r22 = r0->srcPath;
	if( r22 == NULL ) hl_null_access();
	r24 = (String)s$5058f1a;
	r38 = String_split(r22,r24);
	if( r38 == NULL ) hl_null_access();
	r6 = hl_types_ArrayObj_pop(r38);
	r22 = (String)r6;
	r24 = NULL;
	r49 = (String)s$envd;
	if( r22 == r49 || (r22 && r49 && String___compare(r22,(vdynamic*)r49) == 0) ) goto label$02763ed_2_389;
	r49 = (String)s$envs;
	if( r22 != r49 && (!r22 || !r49 || String___compare(r22,(vdynamic*)r49) != 0) ) goto label$02763ed_2_407;
	label$02763ed_2_389:
	r37 = (String)s$TEMP;
	r37 = Sys_getEnv(r37);
	r49 = (String)s$4436f99;
	r37 = String___add__(r37,r49);
	r49 = r0->dstPath;
	if( r49 == NULL ) hl_null_access();
	r50 = (String)s$6666cd7;
	r38 = String_split(r49,r50);
	if( r38 == NULL ) hl_null_access();
	r6 = hl_types_ArrayObj_pop(r38);
	r49 = (String)r6;
	r37 = String___add__(r37,r49);
	r49 = (String)s$_dds;
	r37 = String___add__(r37,r49);
	r24 = r37;
	r49 = r0->srcPath;
	r25 = sys_io_File_getBytes(r49);
	sys_io_File_saveBytes(r37,r25);
	label$02763ed_2_407:
	r37 = (String)s$alpha;
	r7 = hxd_fs_Convert_hasParam(((hxd__fs__Convert)r0),r37);
	if( !r7 ) goto label$02763ed_2_435;
	r49 = (String)s$BC1;
	if( r4 != r49 && (!r4 || !r49 || String___compare(r4,(vdynamic*)r49) != 0) ) goto label$02763ed_2_435;
	if( r23 == NULL ) hl_null_access();
	r31 = &t$String;
	r8 = 4;
	r30 = hl_alloc_array(r31,r8);
	r37 = (String)s$_DXT1UseAlpha;
	r8 = 0;
	((String*)(r30 + 1))[r8] = r37;
	r37 = (String)s$1;
	r8 = 1;
	((String*)(r30 + 1))[r8] = r37;
	r37 = (String)s$_AlphaThreshold;
	r8 = 2;
	((String*)(r30 + 1))[r8] = r37;
	r37 = (String)s$;
	r49 = (String)s$alpha;
	r6 = hxd_fs_Convert_getParam(((hxd__fs__Convert)r0),r49);
	r49 = Std_string(r6);
	r37 = String___add__(r37,r49);
	r8 = 3;
	((String*)(r30 + 1))[r8] = r37;
	r39 = hl_types_ArrayObj_alloc(r30);
	r38 = hl_types_ArrayObj_concat(r23,r39);
	r23 = r38;
	label$02763ed_2_435:
	if( r23 == NULL ) hl_null_access();
	r31 = &t$String;
	r8 = 4;
	r30 = hl_alloc_array(r31,r8);
	r37 = (String)s$_fd;
	r8 = 0;
	((String*)(r30 + 1))[r8] = r37;
	r37 = (String)s$;
	r49 = (String)s$format;
	r6 = hxd_fs_Convert_getParam(((hxd__fs__Convert)r0),r49);
	r49 = Std_string(r6);
	r37 = String___add__(r37,r49);
	r8 = 1;
	((String*)(r30 + 1))[r8] = r37;
	if( r24 ) goto label$02763ed_2_452;
	r37 = r0->srcPath;
	goto label$02763ed_2_453;
	label$02763ed_2_452:
	r37 = r24;
	label$02763ed_2_453:
	r8 = 2;
	((String*)(r30 + 1))[r8] = r37;
	r37 = r0->dstPath;
	r8 = 3;
	((String*)(r30 + 1))[r8] = r37;
	r39 = hl_types_ArrayObj_alloc(r30);
	r38 = hl_types_ArrayObj_concat(r23,r39);
	r37 = (String)s$CompressonatorCLI;
	hxd_fs_Convert_command(((hxd__fs__Convert)r0),r37,r38);
	if( !r24 ) goto label$02763ed_2_464;
	sys_FileSystem_deleteFile(r24);
	label$02763ed_2_464:
	if( !r1 ) goto label$02763ed_2_466;
	sys_FileSystem_deleteFile(r1);
	label$02763ed_2_466:
	return;
}

void hxd_fs_CompressIMG_new(hxd__fs__CompressIMG r0,vvirtual* r1,String r2) {
	hxd_fs_Convert_new(((hxd__fs__Convert)r0),r1,r2);
	return;
}

