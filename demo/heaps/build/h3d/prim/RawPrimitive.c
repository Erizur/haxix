// Generated by HLC 5.0.0 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <h3d/prim/RawPrimitive.h>
extern hl_type t$vrt_bfce37c;
#include <h3d/Engine.h>
void h3d_prim_Primitive_new(h3d__prim__Primitive);
extern hl_type t$fun_95f784f;
extern hl_type t$h3d_col_Bounds;
void h3d_prim_RawPrimitive_alloc(h3d__prim__RawPrimitive,h3d__Engine);
#include <hl/types/ArrayObj.h>
extern String s$Cannot_realloc_;
String Std_string(vdynamic*);
String String___add__(String,String);
extern hl_type t$hl_types_ArrayBytes_hl_F32;
extern hl_type t$hxd_BufferFormat;
h3d__Buffer h3d_Buffer_ofFloats(hl__types__ArrayBytes_hl_F32,hxd__BufferFormat,hl__types__ArrayObj);
extern hl_type t$hl_types_ArrayBytes_hl_UI16;
h3d__Indexes h3d_Indexes_alloc(hl__types__ArrayBytes_hl_UI16,int*,int*);
void h3d_Indexes_dispose(h3d__Indexes);
extern String s$Bounds_not_defined_for_;

vvirtual* h3d_prim_RawPrimitive_new__$1(vvirtual* r0) {
	vvirtual *r1;
	r1 = hl_to_virtual(&t$vrt_bfce37c,(vdynamic*)r0);
	return r1;
}

void h3d_prim_RawPrimitive_new(h3d__prim__RawPrimitive r0,vvirtual* r1,bool* r2) {
	bool r3;
	h3d__col__Bounds r6;
	h3d__Engine r7;
	vclosure *r5;
	if( r2 ) goto label$988e981_2_3;
	r3 = false;
	goto label$988e981_2_4;
	label$988e981_2_3:
	r3 = *r2;
	label$988e981_2_4:
	h3d_prim_Primitive_new(((h3d__prim__Primitive)r0));
	r5 = hl_alloc_closure_ptr(&t$fun_95f784f,h3d_prim_RawPrimitive_new__$1,r1);
	r0->onContextLost = r5;
	if( r1 == NULL ) hl_null_access();
	r6 = hl_vfields(r1)[0] ? (*(h3d__col__Bounds*)(hl_vfields(r1)[0])) : (h3d__col__Bounds)hl_dyn_getp(r1->value,102598660/*bounds*/,&t$h3d_col_Bounds);
	r0->bounds = r6;
	r7 = NULL;
	h3d_prim_RawPrimitive_alloc(r0,r7);
	if( r3 ) goto label$988e981_2_15;
	r5 = NULL;
	r0->onContextLost = r5;
	label$988e981_2_15:
	return;
}

void h3d_prim_RawPrimitive_alloc(h3d__prim__RawPrimitive r0,h3d__Engine r1) {
	String r4, r5;
	hl__types__ArrayObj r10;
	vvirtual *r6;
	hl__types__ArrayBytes_hl_F32 r8;
	hl__types__ArrayBytes_hl_UI16 r12;
	hxd__BufferFormat r9;
	double r13, r14;
	h3d__Buffer r7;
	vclosure *r3;
	int *r17, *r18;
	h3d__Indexes r16;
	int r11, r15;
	r3 = r0->onContextLost;
	if( r3 ) goto label$988e981_3_6;
	r4 = (String)s$Cannot_realloc_;
	r5 = Std_string(((vdynamic*)r0));
	r4 = String___add__(r4,r5);
	hl_throw((vdynamic*)r4);
	label$988e981_3_6:
	r3 = r0->onContextLost;
	if( r3 == NULL ) hl_null_access();
	r6 = r3->hasValue ? ((vvirtual* (*)(vdynamic*))r3->fun)((vdynamic*)r3->value) : ((vvirtual* (*)(void))r3->fun)();
	if( r6 == NULL ) hl_null_access();
	r8 = hl_vfields(r6)[2] ? (*(hl__types__ArrayBytes_hl_F32*)(hl_vfields(r6)[2])) : (hl__types__ArrayBytes_hl_F32)hl_dyn_getp(r6->value,239726983/*vbuf*/,&t$hl_types_ArrayBytes_hl_F32);
	r9 = hl_vfields(r6)[0] ? (*(hxd__BufferFormat*)(hl_vfields(r6)[0])) : (hxd__BufferFormat)hl_dyn_getp(r6->value,-40988873/*format*/,&t$hxd_BufferFormat);
	r10 = NULL;
	r7 = h3d_Buffer_ofFloats(r8,r9,r10);
	r0->buffer = r7;
	r7 = r0->buffer;
	if( r7 == NULL ) hl_null_access();
	r11 = r7->vertices;
	r0->vcount = r11;
	r12 = hl_vfields(r6)[1] ? (*(hl__types__ArrayBytes_hl_UI16*)(hl_vfields(r6)[1])) : (hl__types__ArrayBytes_hl_UI16)hl_dyn_getp(r6->value,95562612/*ibuf*/,&t$hl_types_ArrayBytes_hl_UI16);
	if( !r12 ) goto label$988e981_3_29;
	r12 = hl_vfields(r6)[1] ? (*(hl__types__ArrayBytes_hl_UI16*)(hl_vfields(r6)[1])) : (hl__types__ArrayBytes_hl_UI16)hl_dyn_getp(r6->value,95562612/*ibuf*/,&t$hl_types_ArrayBytes_hl_UI16);
	if( r12 == NULL ) hl_null_access();
	r11 = r12->length;
	r13 = (double)r11;
	r14 = 3.;
	r13 = r13 / r14;
	r15 = (int)r13;
	goto label$988e981_3_34;
	label$988e981_3_29:
	r15 = r0->vcount;
	r13 = (double)r15;
	r14 = 3.;
	r13 = r13 / r14;
	r15 = (int)r13;
	label$988e981_3_34:
	r0->tcount = r15;
	r12 = hl_vfields(r6)[1] ? (*(hl__types__ArrayBytes_hl_UI16*)(hl_vfields(r6)[1])) : (hl__types__ArrayBytes_hl_UI16)hl_dyn_getp(r6->value,95562612/*ibuf*/,&t$hl_types_ArrayBytes_hl_UI16);
	if( !r12 ) goto label$988e981_3_43;
	r12 = hl_vfields(r6)[1] ? (*(hl__types__ArrayBytes_hl_UI16*)(hl_vfields(r6)[1])) : (hl__types__ArrayBytes_hl_UI16)hl_dyn_getp(r6->value,95562612/*ibuf*/,&t$hl_types_ArrayBytes_hl_UI16);
	r17 = NULL;
	r18 = NULL;
	r16 = h3d_Indexes_alloc(r12,r17,r18);
	r0->indexes = r16;
	goto label$988e981_3_50;
	label$988e981_3_43:
	r16 = r0->indexes;
	if( !r16 ) goto label$988e981_3_50;
	r16 = r0->indexes;
	if( r16 == NULL ) hl_null_access();
	h3d_Indexes_dispose(r16);
	r16 = NULL;
	r0->indexes = r16;
	label$988e981_3_50:
	return;
}

h3d__col__Bounds h3d_prim_RawPrimitive_getBounds(h3d__prim__RawPrimitive r0) {
	String r2, r3;
	h3d__col__Bounds r1;
	r1 = r0->bounds;
	if( r1 ) goto label$988e981_4_6;
	r2 = (String)s$Bounds_not_defined_for_;
	r3 = Std_string(((vdynamic*)r0));
	r2 = String___add__(r2,r3);
	hl_throw((vdynamic*)r2);
	label$988e981_4_6:
	r1 = r0->bounds;
	return r1;
}

int h3d_prim_RawPrimitive_triCount(h3d__prim__RawPrimitive r0) {
	int r1;
	r1 = r0->tcount;
	return r1;
}

