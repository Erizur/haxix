// Generated by HLC 5.0.0 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <h2d/impl/BatchDrawState.h>
#include <h3d/mat/Texture.h>
extern hl_type t$h2d_impl__BatchDrawState_StateEntry;
void h2d_impl__BatchDrawState_StateEntry_new(h2d__impl___BatchDrawState__StateEntry,h3d__mat__Texture);
h2d__impl___BatchDrawState__StateEntry h2d_impl__BatchDrawState_StateEntry_set(h2d__impl___BatchDrawState__StateEntry,h3d__mat__Texture);
#include <h2d/RenderContext.h>
#include <h3d/Buffer.h>
#include <h3d/Engine.h>
#include <h3d/Indexes.h>
#include <h3d/impl/MemoryManager.h>
void h2d_RenderContext_beforeDraw(h2d__RenderContext);
h3d__Indexes h3d_impl_MemoryManager_getQuadIndexes(h3d__impl__MemoryManager,int);
void h3d_Engine_renderBuffer(h3d__Engine,h3d__Buffer,h3d__Indexes,int,int*,int*);

void h2d_impl_BatchDrawState_new(h2d__impl__BatchDrawState r0) {
	h2d__impl___BatchDrawState__StateEntry r1;
	int r4;
	h3d__mat__Texture r2;
	r1 = (h2d__impl___BatchDrawState__StateEntry)hl_alloc_obj(&t$h2d_impl__BatchDrawState_StateEntry);
	r2 = NULL;
	h2d_impl__BatchDrawState_StateEntry_new(r1,r2);
	r0->tail = r1;
	r0->head = r1;
	r4 = 0;
	r0->totalCount = r4;
	return;
}

void h2d_impl_BatchDrawState_setTexture(h2d__impl__BatchDrawState r0,h3d__mat__Texture r1) {
	h2d__impl___BatchDrawState__StateEntry r4, r6, r8;
	int r5, r7;
	h3d__mat__Texture r3;
	if( !r1 ) goto label$f1e1159_2_31;
	r4 = r0->tail;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->texture;
	if( r3 ) goto label$f1e1159_2_9;
	r4 = r0->tail;
	if( r4 == NULL ) hl_null_access();
	r4->texture = r1;
	goto label$f1e1159_2_31;
	label$f1e1159_2_9:
	r4 = r0->tail;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->texture;
	if( r3 == r1 ) goto label$f1e1159_2_31;
	r4 = r0->tail;
	if( r4 == NULL ) hl_null_access();
	r5 = r4->count;
	r7 = 0;
	if( r5 != r7 ) goto label$f1e1159_2_20;
	r6 = h2d_impl__BatchDrawState_StateEntry_set(r4,r1);
	goto label$f1e1159_2_31;
	label$f1e1159_2_20:
	r6 = r4->next;
	if( r6 ) goto label$f1e1159_2_27;
	r8 = (h2d__impl___BatchDrawState__StateEntry)hl_alloc_obj(&t$h2d_impl__BatchDrawState_StateEntry);
	h2d_impl__BatchDrawState_StateEntry_new(r8,r1);
	r0->tail = r8;
	r4->next = r8;
	goto label$f1e1159_2_31;
	label$f1e1159_2_27:
	r6 = r4->next;
	if( r6 == NULL ) hl_null_access();
	r6 = h2d_impl__BatchDrawState_StateEntry_set(r6,r1);
	r0->tail = r6;
	label$f1e1159_2_31:
	return;
}

void h2d_impl_BatchDrawState_clear(h2d__impl__BatchDrawState r0) {
	bool r3;
	h2d__impl___BatchDrawState__StateEntry r1, r4;
	int r6;
	h3d__mat__Texture r5;
	r1 = r0->head;
	label$f1e1159_3_1:
	r3 = true;
	if( !r3 ) goto label$f1e1159_3_12;
	if( r1 == NULL ) hl_null_access();
	r5 = NULL;
	r1->texture = r5;
	r4 = r1->next;
	r1 = r4;
	if( r4 ) goto label$f1e1159_3_11;
	goto label$f1e1159_3_12;
	label$f1e1159_3_11:
	goto label$f1e1159_3_1;
	label$f1e1159_3_12:
	r4 = r0->head;
	r0->tail = r4;
	r4 = r0->tail;
	if( r4 == NULL ) hl_null_access();
	r6 = 0;
	r4->count = r6;
	r6 = 0;
	r0->totalCount = r6;
	return;
}

void h2d_impl_BatchDrawState_drawQuads(h2d__impl__BatchDrawState r0,h2d__RenderContext r1,h3d__Buffer r2,int* r3,int* r4) {
	bool r13;
	h3d__Engine r10;
	h3d__impl__MemoryManager r18;
	h2d__impl___BatchDrawState__StateEntry r7, r9, r15;
	h3d__Indexes r17;
	h3d__mat__Texture r14;
	int r5, r6, r11, r12, r16, r19, r20, r21, r22, r23, r24, r25;
	if( r3 ) goto label$f1e1159_4_3;
	r5 = 0;
	goto label$f1e1159_4_4;
	label$f1e1159_4_3:
	r5 = *r3;
	label$f1e1159_4_4:
	if( r4 ) goto label$f1e1159_4_7;
	r6 = -1;
	goto label$f1e1159_4_8;
	label$f1e1159_4_7:
	r6 = *r4;
	label$f1e1159_4_8:
	r7 = r0->head;
	r9 = r0->tail;
	if( r9 == NULL ) hl_null_access();
	r9 = r9->next;
	if( r1 == NULL ) hl_null_access();
	r10 = r1->engine;
	r12 = 0;
	if( r5 != r12 ) goto label$f1e1159_4_50;
	r12 = -1;
	if( r6 != r12 ) goto label$f1e1159_4_50;
	label$f1e1159_4_18:
	r13 = true;
	if( !r13 ) goto label$f1e1159_4_49;
	if( r1 == NULL ) hl_null_access();
	if( r7 == NULL ) hl_null_access();
	r14 = r7->texture;
	r1->texture = r14;
	h2d_RenderContext_beforeDraw(r1);
	r12 = r7->count;
	r16 = 1;
	r12 = r12 >> r16;
	r11 = r12;
	if( r10 == NULL ) hl_null_access();
	r18 = r10->mem;
	if( r18 == NULL ) hl_null_access();
	if( r2 == NULL ) hl_null_access();
	r12 = r2->vertices;
	r17 = h3d_impl_MemoryManager_getQuadIndexes(r18,r12);
	r12 = 2;
	r16 = r5;
	r3 = &r16;
	r19 = r11;
	r4 = &r19;
	h3d_Engine_renderBuffer(r10,r2,r17,r12,r3,r4);
	r12 = r5 + r11;
	r5 = r12;
	r15 = r7->next;
	r7 = r15;
	if( r15 != r9 ) goto label$f1e1159_4_48;
	goto label$f1e1159_4_49;
	label$f1e1159_4_48:
	goto label$f1e1159_4_18;
	label$f1e1159_4_49:
	goto label$f1e1159_4_104;
	label$f1e1159_4_50:
	r20 = -1;
	if( r6 != r20 ) goto label$f1e1159_4_57;
	r12 = r0->totalCount;
	r20 = 1;
	r12 = r12 >> r20;
	r12 = r12 - r5;
	r6 = r12;
	label$f1e1159_4_57:
	r12 = 0;
	label$f1e1159_4_58:
	r13 = true;
	if( !r13 ) goto label$f1e1159_4_104;
	if( r7 == NULL ) hl_null_access();
	r20 = r7->count;
	r21 = 1;
	r20 = r20 >> r21;
	r11 = r20;
	r20 = r12 + r11;
	if( r20 < r5 ) goto label$f1e1159_4_97;
	if( r5 < r12 ) goto label$f1e1159_4_71;
	r20 = r5;
	goto label$f1e1159_4_72;
	label$f1e1159_4_71:
	r20 = r12;
	label$f1e1159_4_72:
	if( r11 >= r6 ) goto label$f1e1159_4_75;
	r21 = r11;
	goto label$f1e1159_4_76;
	label$f1e1159_4_75:
	r21 = r6;
	label$f1e1159_4_76:
	if( r1 == NULL ) hl_null_access();
	r14 = r7->texture;
	r1->texture = r14;
	h2d_RenderContext_beforeDraw(r1);
	if( r10 == NULL ) hl_null_access();
	r18 = r10->mem;
	if( r18 == NULL ) hl_null_access();
	if( r2 == NULL ) hl_null_access();
	r22 = r2->vertices;
	r17 = h3d_impl_MemoryManager_getQuadIndexes(r18,r22);
	r22 = 2;
	r23 = r20;
	r3 = &r23;
	r24 = r21;
	r4 = &r24;
	h3d_Engine_renderBuffer(r10,r2,r17,r22,r3,r4);
	r22 = r6 - r21;
	r6 = r22;
	r25 = 0;
	if( r22 != r25 ) goto label$f1e1159_4_97;
	goto label$f1e1159_4_104;
	label$f1e1159_4_97:
	r20 = r12 + r11;
	r12 = r20;
	r15 = r7->next;
	r7 = r15;
	if( r15 != r9 ) goto label$f1e1159_4_103;
	goto label$f1e1159_4_104;
	label$f1e1159_4_103:
	goto label$f1e1159_4_58;
	label$f1e1159_4_104:
	return;
}

