// Generated by HLC 5.0.0 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <sdl/Sdl.h>
extern sdl__$Sdl g$_sdl_Sdl;
#include <hl/natives.h>
extern String s$Failed_to_init_SDL;
hl__types__ArrayObj sdl_Sdl_getDevices(void);
extern String s$Unknown;
extern String s$ed3530b;
String String___add__(String,String);
extern String s$_video_card_OpenGL_;
String String___alloc__(vbyte*,int);
extern String s$5058f1a;
extern String s$960bc11;
extern String s$OpenGL_Error;
bool hl_UI_dialog(String,String,int);
extern hl_type t$vrt_410ba1a;
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);
extern hl_type t$vrt_f78a381;
extern hl_type t$_dyn;
extern hl_type t$nul_i32;
extern String s$;
extern hl_type t$_bytes;
String String_fromUTF8(vbyte*);
extern String s$bbee82c;
extern String s$9371d7a;
extern hl_type t$String;
extern hl_type t$_i32;
#include <haxe/ds/StringMap.h>
extern hl_type t$haxe_ds_StringMap;
void haxe_ds_StringMap_new(haxe__ds__StringMap);
String StringTools_trim(String);
bool haxe_ds_StringMap_exists(haxe__ds__StringMap,String);
extern String s$RDP;
bool StringTools_startsWith(String,String);
void haxe_ds_StringMap_set(haxe__ds__StringMap,String,vdynamic*);

void sdl_Sdl_init() {
	String r3;
	sdl__$Sdl r2;
	bool r1;
	r2 = (sdl__$Sdl)g$_sdl_Sdl;
	r1 = r2->initDone;
	if( !r1 ) goto label$3370605_1_4;
	return;
	label$3370605_1_4:
	r1 = true;
	r2 = (sdl__$Sdl)g$_sdl_Sdl;
	r2->initDone = r1;
	r1 = sdl_init_once();
	if( r1 ) goto label$3370605_1_11;
	r3 = (String)s$Failed_to_init_SDL;
	hl_throw((vdynamic*)r3);
	label$3370605_1_11:
	r1 = sdl_detect_win32();
	r2 = (sdl__$Sdl)g$_sdl_Sdl;
	r2->isWin32 = r1;
	return;
}

bool sdl_Sdl_onGlContextRetry() {
	bool r0;
	r0 = false;
	return r0;
}

void sdl_Sdl_onGlContextError() {
	String r4, r7, r9;
	hl__types__ArrayObj r0;
	bool r13;
	sdl__$Sdl r10;
	int *r11;
	vdynamic *r5;
	vbyte *r12;
	varray *r6;
	int r2, r3, r8;
	r0 = sdl_Sdl_getDevices();
	if( r0 == NULL ) hl_null_access();
	r2 = 0;
	r3 = r0->length;
	if( ((unsigned)r2) < ((unsigned)r3) ) goto label$3370605_3_7;
	r4 = NULL;
	goto label$3370605_3_10;
	label$3370605_3_7:
	r6 = r0->array;
	r5 = ((vdynamic**)(r6 + 1))[r2];
	r4 = (String)r5;
	label$3370605_3_10:
	if( r4 ) goto label$3370605_3_13;
	r7 = (String)s$Unknown;
	r4 = r7;
	label$3370605_3_13:
	r2 = 0;
	r8 = 2;
	r3 = r2 | r8;
	r2 = r3;
	r7 = (String)s$ed3530b;
	r7 = String___add__(r7,r4);
	r9 = (String)s$_video_card_OpenGL_;
	r7 = String___add__(r7,r9);
	r10 = (sdl__$Sdl)g$_sdl_Sdl;
	r3 = r10->requiredGLMajor;
	r11 = &r3;
	r12 = hl_itos(r3,r11);
	r9 = String___alloc__(r12,r3);
	r7 = String___add__(r7,r9);
	r9 = (String)s$5058f1a;
	r7 = String___add__(r7,r9);
	r10 = (sdl__$Sdl)g$_sdl_Sdl;
	r3 = r10->requiredGLMinor;
	r11 = &r3;
	r12 = hl_itos(r3,r11);
	r9 = String___alloc__(r12,r3);
	r7 = String___add__(r7,r9);
	r9 = (String)s$960bc11;
	r7 = String___add__(r7,r9);
	r9 = (String)s$OpenGL_Error;
	r13 = hl_UI_dialog(r9,r7,r2);
	r3 = -1;
	hl_sys_exit(r3);
	return;
}

bool sdl_Sdl_processEvents(vclosure* r0) {
	sdl__$Sdl r3;
	bool r1, r6;
	sdl__Event r2;
	int r4, r5;
	label$3370605_4_0:
	r3 = (sdl__$Sdl)g$_sdl_Sdl;
	r2 = r3->event;
	r1 = sdl_event_loop(((vdynamic*)r2));
	if( !r1 ) goto label$3370605_4_19;
	if( r0 == NULL ) hl_null_access();
	r3 = (sdl__$Sdl)g$_sdl_Sdl;
	r2 = r3->event;
	r1 = r0->hasValue ? ((bool (*)(vdynamic*,sdl__Event))r0->fun)((vdynamic*)r0->value,r2) : ((bool (*)(sdl__Event))r0->fun)(r2);
	r3 = (sdl__$Sdl)g$_sdl_Sdl;
	r2 = r3->event;
	if( r2 == NULL ) hl_null_access();
	r4 = r2->type;
	r5 = 0;
	if( r4 != r5 ) goto label$3370605_4_18;
	if( !r1 ) goto label$3370605_4_18;
	r6 = false;
	return r6;
	label$3370605_4_18:
	goto label$3370605_4_0;
	label$3370605_4_19:
	r1 = true;
	return r1;
}

hl__types__ArrayObj sdl_Sdl_getDisplayModes(vdynamic* r0) {
	hl__types__ArrayObj r4;
	hl_type *r5;
	vdynamic *r6;
	int r2, r7, r8;
	varray *r1, *r3;
	r2 = r0 ? r0->v.i : 0;
	r1 = sdl_get_display_modes(r2);
	if( r1 ) goto label$3370605_5_8;
	r5 = &t$vrt_410ba1a;
	r2 = 0;
	r3 = hl_alloc_array(r5,r2);
	r4 = hl_types_ArrayObj_alloc(r3);
	return r4;
	label$3370605_5_8:
	r5 = &t$vrt_410ba1a;
	r2 = 0;
	r3 = hl_alloc_array(r5,r2);
	r4 = hl_types_ArrayObj_alloc(r3);
	r2 = 0;
	label$3370605_5_13:
	r8 = r1->size;
	if( r2 >= r8 ) goto label$3370605_5_21;
	r6 = ((vdynamic**)(r1 + 1))[r2];
	++r2;
	if( r4 == NULL ) hl_null_access();
	r7 = hl_types_ArrayObj_push(r4,r6);
	goto label$3370605_5_13;
	label$3370605_5_21:
	return r4;
}

vvirtual* sdl_Sdl_getCurrentDisplayMode(vdynamic* r0,bool* r1) {
	vvirtual *r5;
	bool r2;
	vdynamic *r3;
	int r4;
	if( r1 ) goto label$3370605_6_3;
	r2 = false;
	goto label$3370605_6_4;
	label$3370605_6_3:
	r2 = *r1;
	label$3370605_6_4:
	r4 = r0 ? r0->v.i : 0;
	r3 = sdl_get_current_display_mode(r4,r2);
	r5 = hl_to_virtual(&t$vrt_410ba1a,(vdynamic*)r3);
	return r5;
}

hl__types__ArrayObj sdl_Sdl_getDisplays() {
	String r12, r13;
	vvirtual *r9;
	hl__types__ArrayObj r2;
	hl_type *r3;
	int *r15;
	vdynamic *r5, *r10, *r11;
	vbyte *r14;
	int r4, r6, r7, r8;
	varray *r0, *r1;
	r0 = sdl_get_displays();
	if( r0 ) goto label$3370605_7_7;
	r3 = &t$vrt_f78a381;
	r4 = 0;
	r1 = hl_alloc_array(r3,r4);
	r2 = hl_types_ArrayObj_alloc(r1);
	return r2;
	label$3370605_7_7:
	r4 = 0;
	r3 = &t$vrt_f78a381;
	r6 = 0;
	r1 = hl_alloc_array(r3,r6);
	r2 = hl_types_ArrayObj_alloc(r1);
	r6 = 0;
	r1 = sdl_get_displays();
	label$3370605_7_14:
	r8 = r1->size;
	if( r6 >= r8 ) goto label$3370605_7_55;
	r7 = r6;
	r5 = ((vdynamic**)(r1 + 1))[r6];
	++r6;
	if( r2 == NULL ) hl_null_access();
	r9 = hl_alloc_virtual(&t$vrt_f78a381);
	if( r5 == NULL ) hl_null_access();
	r10 = (vdynamic*)hl_dyn_getp((vdynamic*)r5,-134380898/*handle*/,&t$_dyn);
	r11 = (vdynamic*)hl_dyn_castp(&r10,&t$_dyn,&t$nul_i32);
	if( hl_vfields(r9)[1] ) *(vdynamic**)(hl_vfields(r9)[1]) = (vdynamic*)r11; else hl_dyn_setp(r9->value,-134380898/*handle*/,&t$nul_i32,r11);
	r12 = (String)s$;
	r10 = (vdynamic*)hl_dyn_getp((vdynamic*)r5,150958933/*name*/,&t$_dyn);
	r14 = (vbyte*)hl_dyn_castp(&r10,&t$_dyn,&t$_bytes);
	r13 = String_fromUTF8(r14);
	r12 = String___add__(r12,r13);
	r13 = (String)s$bbee82c;
	r12 = String___add__(r12,r13);
	++r4;
	r15 = &r7;
	r14 = hl_itos(r4,r15);
	r13 = String___alloc__(r14,r7);
	r12 = String___add__(r12,r13);
	r13 = (String)s$9371d7a;
	r12 = String___add__(r12,r13);
	if( hl_vfields(r9)[3] ) *(String*)(hl_vfields(r9)[3]) = (String)r12; else hl_dyn_setp(r9->value,150958933/*name*/,&t$String,r12);
	r10 = (vdynamic*)hl_dyn_getp((vdynamic*)r5,128977169/*left*/,&t$_dyn);
	r7 = (int)hl_dyn_casti(&r10,&t$_dyn,&t$_i32);
	if( hl_vfields(r9)[2] ) *(int*)(hl_vfields(r9)[2]) = (int)r7; else hl_dyn_seti(r9->value,128977169/*left*/,&t$_i32,r7);
	r10 = (vdynamic*)hl_dyn_getp((vdynamic*)r5,5793429/*top*/,&t$_dyn);
	r7 = (int)hl_dyn_casti(&r10,&t$_dyn,&t$_i32);
	if( hl_vfields(r9)[5] ) *(int*)(hl_vfields(r9)[5]) = (int)r7; else hl_dyn_seti(r9->value,5793429/*top*/,&t$_i32,r7);
	r10 = (vdynamic*)hl_dyn_getp((vdynamic*)r5,-379319332/*right*/,&t$_dyn);
	r7 = (int)hl_dyn_casti(&r10,&t$_dyn,&t$_i32);
	if( hl_vfields(r9)[4] ) *(int*)(hl_vfields(r9)[4]) = (int)r7; else hl_dyn_seti(r9->value,-379319332/*right*/,&t$_i32,r7);
	r10 = (vdynamic*)hl_dyn_getp((vdynamic*)r5,91809914/*bottom*/,&t$_dyn);
	r7 = (int)hl_dyn_casti(&r10,&t$_dyn,&t$_i32);
	if( hl_vfields(r9)[0] ) *(int*)(hl_vfields(r9)[0]) = (int)r7; else hl_dyn_seti(r9->value,91809914/*bottom*/,&t$_i32,r7);
	r7 = hl_types_ArrayObj_push(r2,((vdynamic*)r9));
	goto label$3370605_7_14;
	label$3370605_7_55:
	return r2;
}

hl__types__ArrayObj sdl_Sdl_getDevices() {
	String r9, r10, r12;
	haxe__ds__StringMap r5;
	hl__types__ArrayObj r0;
	hl_type *r2;
	bool r11;
	vdynamic *r13;
	vbyte *r8;
	int r3, r6, r7;
	varray *r1;
	r2 = &t$String;
	r3 = 0;
	r1 = hl_alloc_array(r2,r3);
	r0 = hl_types_ArrayObj_alloc(r1);
	r1 = sdl_get_devices();
	r5 = (haxe__ds__StringMap)hl_alloc_obj(&t$haxe_ds_StringMap);
	haxe_ds_StringMap_new(r5);
	r3 = 0;
	label$3370605_8_8:
	r7 = r1->size;
	if( r3 >= r7 ) goto label$3370605_8_34;
	r8 = ((vbyte**)(r1 + 1))[r3];
	++r3;
	if( r8 ) goto label$3370605_8_15;
	goto label$3370605_8_34;
	label$3370605_8_15:
	r9 = (String)hl_alloc_obj(&t$String);
	r9->bytes = r8;
	r6 = 0;
	r6 = hl_ucs2length(r8,r6);
	r9->length = r6;
	r10 = StringTools_trim(r9);
	if( r5 == NULL ) hl_null_access();
	r11 = haxe_ds_StringMap_exists(r5,r10);
	if( r11 ) goto label$3370605_8_27;
	r12 = (String)s$RDP;
	r11 = StringTools_startsWith(r10,r12);
	if( !r11 ) goto label$3370605_8_28;
	label$3370605_8_27:
	goto label$3370605_8_8;
	label$3370605_8_28:
	r11 = true;
	r13 = hl_alloc_dynbool(r11);
	haxe_ds_StringMap_set(r5,r10,r13);
	if( r0 == NULL ) hl_null_access();
	r6 = hl_types_ArrayObj_push(r0,((vdynamic*)r10));
	goto label$3370605_8_8;
	label$3370605_8_34:
	return r0;
}

